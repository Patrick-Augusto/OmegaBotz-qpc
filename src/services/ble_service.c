/***************************************************************************************************
 * INCLUDES
 **************************************************************************************************/
#include <stdbool.h>
#include <stdio.h>
#include <string.h>

#include "ble_service.h"
#include "bsp_ble.h"
#include "bsp.h"
#include "qpc.h"    


/***************************************************************************************************
 * LOCAL DEFINES
 **************************************************************************************************/

/***************************************************************************************************
 * LOCAL TYPEDEFS
 **************************************************************************************************/

/***************************************************************************************************
 * LOCAL FUNCTION PROTOTYPES
 **************************************************************************************************/
static void ble_callback(uint8_t * ble_data);
volatile static uint8_t * ble_last_data[BLE_PACKET_SIZE];

/***************************************************************************************************
 * LOCAL VARIABLES
 **************************************************************************************************/

/***************************************************************************************************
 * GLOBAL VARIABLES
 **************************************************************************************************/

/***************************************************************************************************
 * LOCAL FUNCTIONS
 **************************************************************************************************/

static void ble_callback(uint8_t * ble_data) {

    // QEvt evt = {.sig = BLE_DATA_SIG};
    // QHSM_DISPATCH(&AO_SumoHSM->super, &evt, SIMULATOR);

}


/***************************************************************************************************
 * GLOBAL FUNCTIONS
 **************************************************************************************************/

void ble_service_init(void){
    printf("BLE Service Init\r\n");
    bsp_ble_init();
    bsp_ble_register_callback(ble_callback);
}


void ble_service_send_data(uint8_t * data, uint8_t size){

    bsp_ble_transmit(data, size);

}

void ble_service_last_packet(uint8_t * data){

    memcpy(data, ble_last_data, BLE_PACKET_SIZE);

}

